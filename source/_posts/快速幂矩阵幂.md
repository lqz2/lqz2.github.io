---
title: 快速幂矩阵幂
date: 2022-08-23 10:56:25
categories: 机试
tags:
---
<!-- TOC -->

- [例1 快速幂](#例1-快速幂)
- [例2 矩阵幂](#例2-矩阵幂)

<!-- /TOC -->
>**快速幂** 快速幂常用于计算指数非常大的幂，核心思想就是每一步都把指数分成两半，而相应的底数做平方运算。这样不仅能把非常大的指数给不断变小，所需要执行的循环次数也变小，而最后表示的结果却一直不会变。

*直接看例题*

### 例1 快速幂

输入三个数字a,b,c,输出 a^b **mod** c
input:
```
2 10 10
```
output:
```
4
```
代码
```
#include<bits/stdc++.h>
using namespace std;
int a,b,c;
int ksm()
{
	int ans=1;
	a=a%c;
	while(b>0)
	{
		if(b%2)
			ans=(ans*a)%c;
		a=(a*a)%c;
		b/=2;
	}
	return ans;
}
int main()
{
	cin>>a>>b>>c;
	cout<<ksm()<<endl;
}
```
### 例2 矩阵幂

描述
给定一个n*n的矩阵，输出矩阵的k次方

输入描述
有多组输入，第一行输入n和k
后面n行输入矩阵元素
2<=n<=10,1<=k<=5
输出描述
每组输入输出矩阵的k次方
input:
```
2 2
9 8
9 3
3 3
4 8 4
9 3 0
3 5 7
5 2
4 0 3 0 1
0 0 5 8 5
8 9 8 5 3
9 6 1 7 8
7 2 5 7 3
```
output:
```
153 96
108 81
1216 1248 708
1089 927 504
1161 1151 739
47 29 41 22 16
147 103 73 116 94
162 108 153 168 126
163 67 112 158 122
152 93 93 111 97
```
代码：
```
#include<bits/stdc++.h>
using namespace std;
class M
{
public:
    int row;
    int col;
    int m[11][11];
    M(int r,int c):row(r),col(c)
    {
        for(int i=0;i<row;++i)
        {
            for(int j=0;j<col;++j)
            {
                if(i==j)
                    m[i][j]=1;
                else
                    m[i][j]=0;
            }
        }      
    }
    void input()
    {
        for(int i=0;i<row;++i)
        {
            for(int j=0;j<col;++j)
                cin>>m[i][j];
        } 
    }
    void output()
    {
        for(int i=0;i<row;++i)
        {
            for(int j=0;j<col;++j)
                cout<<m[i][j]<<' ';
            cout<<endl;
        }
    }
    M operator* (const M& t) const
    {
        M ans(row,t.col);
        memset(ans.m,0,sizeof(ans.m));
        for(int i=0;i<row;++i)
        {
            for(int j=0;j<t.col;++j)
            {
                for(int k=0;k<col;++k)
                {
                    ans.m[i][j]+=m[i][k]*t.m[k][j];
                }
            }
        }
        return ans;
    }

};
M ksm(M a,int k)
{
    M ans(a.row,a.col);
    while(k>0)
    {
        if(k%2)
            ans=ans*a;
        a=a*a;
        k/=2;
    }
    return ans; 
}
int main()
{
    int n,k;
    while(cin>>n>>k)
    {
        M a(n,n);
        a.input();
        M ans=ksm(a,k);
        ans.output();
    }
    return 0;
}
```

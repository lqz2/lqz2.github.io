---
title: 除法求值
date: 2024-09-24 09:41:49
categories: 机试
math:
tags:
---
## 除法求值

<!-- TOC -->

- [除法求值](#除法求值)
    - [题目描述](#题目描述)
    - [思路](#思路)
    - [代码](#代码)

<!-- /TOC -->

[原题](https://leetcode.cn/problems/evaluate-division/description)


### 题目描述
给你一个变量对数组 equations 和一个实数值数组 values 作为已知条件，其中 equations[i] = [Ai, Bi] 和 values[i] 共同表示等式 Ai / Bi = values[i] 。每个 Ai 或 Bi 是一个表示单个变量的字符串。

另有一些以数组 queries 表示的问题，其中 queries[j] = [Cj, Dj] 表示第 j 个问题，请你根据已知条件找出 Cj / Dj = ? 的结果作为答案。

返回 所有问题的答案 。如果存在某个无法确定的答案，则用 -1.0 替代这个答案。如果问题中出现了给定的已知条件中没有出现的字符串，也需要用 -1.0 替代这个答案。

注意：输入总是有效的。你可以假设除法运算中不会出现除数为 0 的情况，且不存在任何矛盾的结果。

注意：未在等式列表中出现的变量是未定义的，因此无法确定它们的答案。

e.g.
```
输入：equations = [["a","b"],["b","c"]], values = [2.0,3.0], queries = [["a","c"],["b","a"],["a","e"],["a","a"],["x","x"]]
输出：[6.00000,0.50000,-1.00000,1.00000,-1.00000]
解释：
条件：a / b = 2.0, b / c = 3.0
问题：a / c = ?, b / a = ?, a / e = ?, a / a = ?, x / x = ?
结果：[6.0, 0.5, -1.0, 1.0, -1.0 ]
注意：x 是未定义的 => -1.0
```
### 思路
这道题参考了评论区大佬的思路，非常简洁清晰。用一个set记录所有出现过的字符串，然后用一个map保存两个字符串间的运算结果，如字符串a除以b可表示为mp[a][b]。
接下来，对于字符串之间的运算，采用Floyd算法，遍历set中的字符串，如果`mp[i][k] && mp[k][j]`，那么可以计算得到`mp[i][j]=mp[i][k]*mp[k][j];`，对于query中的字符串`(a,b)`，若`mp[a][b]`不为0,则返回对应的值，若为0则返回-1。
### 代码
```
class Solution {
public:
    vector<double> calcEquation(vector<vector<string>>& equations, vector<double>& values, vector<vector<string>>& queries) {
        int n=equations.size();
        unordered_set<string> s;
        unordered_map<string, unordered_map<string, double>> mp;
        for(int i=0;i<n;++i){
            string a=equations[i][0],b=equations[i][1];
            double c=values[i];
            mp[a][b]=c;
            mp[b][a]=1.0/c;
            s.insert(a);
            s.insert(b);
        }
        for(string k:s){
            for(string i:s){
                for(string j:s){
                    if(mp[i][k] && mp[k][j]){
                        mp[i][j]=mp[i][k]*mp[k][j];
                    }
                }
            }
        }
        vector<double> res;
        for(auto &t:queries){
            string a=t[0],b=t[1];
            if(mp[a][b])
                res.push_back(mp[a][b]);
            else
                res.push_back(-1.0);
        }
        return res;
    }
};
```